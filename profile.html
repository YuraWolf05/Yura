<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Profile APEXIA</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='profile.css') }}">
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='favicon.png') }}?v=1">
</head>
<body>
<header>
    <div class="container">
        <!-- –õ—ñ–≤–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (–ü—Ä–æ—Ñ—ñ–ª—å) -->
        <div class="profile-container">
            <h2>–õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—Å–∏–º–æ, {{ user.name }}!</h2>
            <img src="{{ user.profile_image_url }}" alt="–§–æ—Ç–æ –ø—Ä–æ—Ñ—ñ–ª—é" class="profile-image">

            <p><strong>Email:</strong> {{ user.email }}</p>
            <p><strong>–ù–æ–º–µ—Ä:</strong> {{ user.number or "–ù–µ –≤–∫–∞–∑–∞–Ω–æ" }}</p>
            <p><strong>–î–∞—Ç–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó:</strong> {{ user.date_joined.strftime('%Y-%m-%d %H:%M:%S') }}</p>

            <form method="post" action="{{ url_for('profile') }}" enctype="multipart/form-data">
                <label for="name">–Ü–º'—è:</label>
                <input type="text" id="name" name="name" value="{{ user.name }}" required>

                <label for="email">–ï–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞ –ø–æ—à—Ç–∞:</label>
                <input type="email" id="email" name="email" value="{{ user.email }}" required>

                <label for="password">–ù–æ–≤–∏–π –ø–∞—Ä–æ–ª—å:</label>
                <input type="password" id="password" name="password" placeholder="–û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ">
                <div class="toggle-password">
                    <input type="checkbox" id="showPassword">
                    <label for="showPassword">üëÅÔ∏èüîì</label>
                </div>

                <label for="profile_image">–§–æ—Ç–æ –ø—Ä–æ—Ñ—ñ–ª—é:</label>
                <input type="file" id="profile_image" name="profile_image" accept="image/*">

                <button type="submit">–û–Ω–æ–≤–∏—Ç–∏</button>
            </form>

            <!-- –ö–Ω–æ–ø–∫–∏ -->
            <div class="buttons-container">
                <button onclick="window.location.href='{{ url_for('home') }}'">–ì–æ–ª–æ–≤–Ω–∞</button>
                <button onclick="window.location.href='{{ url_for('logout') }}'">–í–∏–π—Ç–∏</button>

                {% if current_user.is_authenticated and current_user.is_admin %}
                    <button onclick="window.location.href='{{ url_for('admin_receipts') }}'">Admin</button>
               <!--<button onclick="window.location.href='{{ url_for('admin_panel_secretly') }}'">panel_secretly</button>-->
                {% endif %}
            </div>
        </div>

        <!-- –ü—Ä–∞–≤–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è) -->
        <div class="orders-container">
            <h2>–Ü—Å—Ç–æ—Ä—ñ—è –∑–∞–º–æ–≤–ª–µ–Ω—å</h2>
            <div>
                {% if orders %}
                {% for order in orders %}
                    <div class="order">
                        <p><strong>–¢–æ–≤–∞—Ä:</strong> {{ order.product_name }}</p>
                        <p><strong>–ö—ñ–ª—å–∫—ñ—Å—Ç—å:</strong> {{ order.quantity }}</p>
                        <p><strong>–î–∞—Ç–∞:</strong> {{ order.date.strftime('%Y-%m-%d %H:%M:%S') }}</p>
                        <p><strong>–ü—Ä–æ–º–æ-–∫–æ–¥:</strong>
                            {% if order.status == '–í—ñ–¥—Ö–∏–ª–µ–Ω–æ' %}
                                –í—ñ–¥—Ö–∏–ª–µ–Ω–æ
                            {% elif order.promo_code_confirmed %}
                                {{ order.promo_code }}
                            {% else %}
                                –û—á—ñ–∫—É—î –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è
                            {% endif %}
                        </p>
                    </div>
                {% endfor %}
            {% else %}
                <p>–£ –≤–∞—Å –ø–æ–∫–∏ –Ω–µ–º–∞—î –∑–∞–º–æ–≤–ª–µ–Ω—å.</p>
            {% endif %}
            </div>
        </div>
    </div>
</header>

<script>
    document.getElementById("showPassword").addEventListener("change", function () {
        let passwordField = document.getElementById("password");
        passwordField.type = this.checked ? "text" : "password";
    });
</script>
</body>
</html>
